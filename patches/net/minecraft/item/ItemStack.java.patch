--- a/net/minecraft/item/ItemStack.java
+++ b/net/minecraft/item/ItemStack.java
@@ -1,5 +1,6 @@
 package net.minecraft.item;
 
+import carpet.CarpetSettings;
 import com.google.common.collect.HashMultimap;
 import com.google.common.collect.Lists;
 import com.google.common.collect.Multimap;
@@ -19,6 +20,7 @@
 import javax.annotation.Nullable;
 import net.minecraft.advancements.CriteriaTriggers;
 import net.minecraft.block.Block;
+import net.minecraft.block.BlockShulkerBox;
 import net.minecraft.block.state.BlockWorldState;
 import net.minecraft.block.state.IBlockState;
 import net.minecraft.client.util.ITooltipFlag;
@@ -224,6 +226,11 @@
 
     public int getMaxStackSize()
     {
+        if (this.getItem() instanceof ItemBlock && ((ItemBlock) this.getItem()).getBlock() instanceof BlockShulkerBox && CarpetSettings.getBool("stackableEmptyShulkerBoxes"))
+        {
+            return hasTag() ? 1 : 64;
+        }
+
         return this.getItem().getMaxStackSize();
     }
 
